Many issues with this older code as I go through and update